{% extends 'bgpWebApp/base.html' %}

{% block title %}Query{% endblock %}

{% block headers %}{% endblock %}

{% block content %}
	<h1> Enter your VAST query:</h1>
	<form action="{% url 'bgpWebApp:query' %}" method="post">
		{% csrf_token %}
		{{ form }}
		<input type="submit" value="Table" name="table"></td>
		<td><input type="submit" value="Graph" name="graph"</td>
		</tr>
	</form>
	
	<div class="result">
		{% if query != None %}
			<hr>

			<!-- TABLE -->
			{% if is_json and representation == 'table'  %}
				<table class="result_table display" id="result_table">
					<thead>
					<tr>
					{% for title in http_content.header %}
						<th>{{ title }}</th>
					{% endfor %}
					</tr>
					</thead>
					<tbody>
					{% for row in http_content.table %}
						<tr>
							{% for entry in row %}
								<td> {{ entry }}</td>
							{% endfor %}
						</tr>
					{% endfor %}
					</tbody>
				</table>
					</div>
				</div>
				<script>
					$(document).ready(function() {
						$('#result_table').DataTable();
					});	
				</script>	
			{% endif %}		
	
			<!-- GRAPH -->
			{% if is_json and representation == 'graph' %}
				<h1> Make a graph god damn!</h1>
				<div id="network_graph"></div>
				<script type="text/javascript">
					var nodes = new vis.DataSet([
					{% for row in http_json_content.table %}
						{% for entry in row %}
						{% endfor %}
					{% endfor %}			
						
						{id: 1, label: 'Node1'},
						{id: 2, label: 'Node2'},
						{id: 3, label: 'Node3'}
					]);
					var edges = new vis.DataSet([
						{from: 1, to:2},
						{from: 2, to:3}
					])
				var container = document.getElementById('network_graph');
				var data = { nodes: nodes, edges: edges};
				var options = {}
				var newtwork = new vis.Network(container, data, options);
			</script>
			{% endif %}

			<!-- EVERYTHING ELSE -->
			{% if not is_json and representation == 'text' %}
				<h1> No json result!</h1>
				<div id="found">
					For your query: {{ query }} <br>
					We just found this: {{ content_text }}
				</div>
			{% endif %}

		{% endif %}
	</div>
{% endblock %}
